@using Newtonsoft.Json;

<head>
    <meta charset="UTF-8">
    <title>Parameters</title>
    <!-- Подключаем MathJax для рендеринга формул -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: sans-serif;
            margin: 0;
            padding: 0; /* padding обнулили */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            color: #dddddd;
            font-size: 30px;
            margin-bottom: 5px;
        }

        .formula-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 5px;
        }

        .formula-section {
            background-color: #222;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .formula-title {
            font-size: 20px;
            color: #dddddd;
            margin-bottom: 5px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }

        .formula {
            background-color: #333;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            overflow-x: auto;
        }

        .formula-group {
            margin-bottom: 15px;
        }

        .formula-group-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #fd817e; /* заменён цвет */
        }

        .parameters-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 5px;
        }

        .parameter-group {
            background-color: #222;
            padding: 10px;
            border-radius: 10px;
            flex: 1;
            min-width: 300px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            margin-bottom: 5px;
        }

        .parameter-title {
            font-size: 18px;
            color: #dddddd;
            margin-bottom: 5px;
        }

        .parameter-item {
            margin-bottom: 5px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #dddddd;
        }

        select, input {
            width: 100%;
            padding: 5px;
            background-color: #333;
            color: white;
            border: 1px solid #444;
            border-radius: 5px;
        }

        .btn-submit {
            background-color: #fd817e;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin-top: 5px;
        }

        .btn-submit:hover {
            background-color: #ff9a97;
        }

        .correction-window {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border: 1px solid #444;
        }

        .correction-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #dddddd;
        }

        .correction-item {
            margin-bottom: 8px;
        }

        .correction-label {
            color: #aaaaaa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Параметры и формулы</h1>
        
        <div class="formula-container">
            <div class="formula-section">
                <div class="formula-title">Основные формулы расчета:</div>
                
                <div class="formula-group">
                    <div class="formula-group-title">Для турбин:</div>
                    <div class="formula">
                        $$\text{УРТ\%} = \frac{\text{Фактический УРТ} - \text{Нормативный УРТ}}{\text{Фактический УРТ}} \times 100$$
                    </div>
                </div>
                
                <div class="formula-group">
                    <div class="formula-group-title">Для котлов:</div>
                    <div class="formula">
                        $$\text{КПД\%} = \frac{\text{Фактический КПД} - \text{Нормативный КПД}}{\text{Фактический КПД}} \times 100$$
                    </div>
                </div>
                
                <div class="formula-group">
                    <div class="formula-group-title">Рейтинг станции:</div>
                    <div class="formula">
                        $$\text{Рейтинг} = \frac{\sum(\text{УРТ\%} \cdot \text{Расход тепла}) \cdot (-1) + \sum(\text{КПД\%} \cdot \text{Выработка тепла}) \cdot 2}{\text{Общий объём}}$$
                    </div>
                </div>
            </div>
            
            <div class="formula-section">
                <div class="formula-title">Формулы определения фактических значений:</div>
                
                <div class="formula-group">
                    <div class="formula-group-title">Фактический КПД котла:</div>
                    <div class="formula">
                        $$\eta_{K(БР)}^{НОМ} = \eta_{K(БР)}^{КР} - \Delta q_4^{W_P} - \Delta q_4^{A_R} + (t_{ХВ}^{ФАКТ} - t_{ХВ}^{НОМ}) \cdot \Delta \eta_{K(БР)}^{ХВ}$$
                    </div>
                </div>
                
                <div class="formula-group">
                    <div class="formula-group-title">Фактический УРТ турбины:</div>
                    <div class="formula">
                        $$q_{T(БР)}^{НОМ} = q_{T(БР)}^{КР} + \Delta q_{T(БР)}^{P_2}$$
                    </div>
                </div>
            </div>
        </div>
        
        <form method="get" action="/Home/Index">
            <div class="parameters-container">
                <div class="parameter-group">
                    <div class="parameter-title">Тип оборудования</div>
                    <div class="parameter-item">
                        <label for="equipmentType">Выберите тип:</label>
                        <select id="equipmentType" name="equipmentType">
                            <option value="turbine">Турбина</option>
                            <option value="boiler">Котёл</option>
                        </select>
                    </div>
                    
                    <!-- Окно поправок -->
                    <div class="correction-window" id="correctionsWindow">
                        <div class="correction-title">Поправки:</div>
                        <div class="correction-item">
                            <label class="correction-label">Поправка 1:</label>
                            <input type="number" step="0.01" value="0">
                        </div>
                        <div class="correction-item">
                            <label class="correction-label">Поправка 2:</label>
                            <input type="number" step="0.01" value="0">
                        </div>
                        <div class="correction-item">
                            <label class="correction-label">Поправка 3:</label>
                            <input type="number" step="0.01" value="0">
                        </div>
                    </div>
                </div>
                
                <div class="parameter-group">
                    <div class="parameter-title">Станция</div>
                    <div class="parameter-item">
                        <label for="station">Выберите станцию:</label>
                        <select id="station" name="station">
                            <option value="25">РГРЭС</option>
                            <option value="9">ТУГРЭС</option>
                            <option value="15">БГРЭС</option>
                            <option value="1">НГРЭС</option>
                            <option value="24">КГРЭС2</option>
                            <option value="26">ПГРЭС</option>
                        </select>
                    </div>
                </div>
                
                <div class="parameter-group">
                    <div class="parameter-title">Оборудование</div>
                    <div class="parameter-item">
                        <label for="equipmentId">Выберите оборудование:</label>
                        <select id="equipmentId" name="equipmentId"></select>
                    </div>
                </div>
            </div>
            
            <button type="submit" class="btn-submit">Применить параметры</button>
        </form>
    </div>

    <script>
        const equipmentTypeSelect = document.getElementById('equipmentType');
        const stationSelect = document.getElementById('station');
        const equipmentIdSelect = document.getElementById('equipmentId');
        
        const equipmentData = {
            turbine: {
                25: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"],
                9: ["1", "2", "3", "4", "5", "6", "7", "8", "9"],
                15: ["1", "2", "3", "4", "5", "6"],
                1: ["1", "2", "3", "4", "5", "6", "7"],
                24: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"],
                26: ["1", "2", "3", "4", "5", "6", "7", "8", "9"]
            },
            boiler: {
                25: ["01А", "01Б", "02А", "02Б", "03А", "03Б", "04А", "04Б", "05А", "05Б", "06А", "06Б", "07", "08", "09", "10"],
                9: ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13А", "13Б", "14А", "14Б"],
                15: ["01А", "01Б", "02А", "02Б", "03А", "03Б", "04А", "04Б", "05А", "05Б", "06А", "06Б"],
                1: ["01А", "01Б", "02А", "02Б", "03А", "03Б", "04А", "04Б", "05А", "05Б", "06А", "06Б", "07А", "07Б"],
                24: ["01А", "01Б", "02А", "02Б", "03А", "03Б", "04А", "04Б", "05А", "05Б", "06А", "06Б", "07А", "07Б", "08А", "08Б", "09А", "09Б", "10А", "10Б"],
                26: ["01А", "01Б", "02А", "02Б", "03А", "03Б", "04А", "04Б", "05", "06", "07", "08", "09"]
            }
        };
        
        function updateEquipmentList() {
            const type = equipmentTypeSelect.value;
            const station = stationSelect.value;
            equipmentIdSelect.innerHTML = '';
            if (equipmentData[type] && equipmentData[type][station]) {
                equipmentData[type][station].forEach(id => {
                    const option = document.createElement('option');
                    option.value = id;
                    option.textContent = (type === 'turbine' ? 'ТА' : 'КА') + id;
                    equipmentIdSelect.appendChild(option);
                });
            }
        }
        
        updateEquipmentList();
        equipmentTypeSelect.addEventListener('change', updateEquipmentList);
        stationSelect.addEventListener('change', updateEquipmentList);
    </script>
</body>
